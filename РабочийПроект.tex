\section{Рабочий проект}
\subsection{Описание REST API приложения}

Можно выделить следующий перечень HTTP-методов, использованных при разработке веб-приложения и доступных для использования клиентской частью приложения. Описание этих методов предоставлены в виде аблиц с уменьшенным межстрочным интервалом:
\begin{itemize}
    \item описания методов для работы с городами (таблица \ref{city:table});
    \item описание методов для работы с карточками товаров и услуг (таблица \ref{product:table});
    \item описание методов для работы с типами товаров и услуг (таблица \ref{type:table});
    \item описание методов для работы с данными пользователя (таблица \ref{data:table}).
\end{itemize}

\renewcommand{\arraystretch}{0.8} % уменьшение расстояний до сетки таблицы

\begin{xltabular}{\textwidth}{|X|p{2.5cm}|>{\setlength{\baselineskip}{0.7\baselineskip}}p{4.85cm}|>{\setlength{\baselineskip}{0.7\baselineskip}}p{4.85cm}|}
    \caption{Описания методов для работы с городами\label{city:table}}\\
    \hline \centrow \setlength{\baselineskip}{0.7\baselineskip} HTTP-метод & \centrow \setlength{\baselineskip}{0.7\baselineskip} Описание & \centrow Входные параметры & \centrow Пример JSON ответа \\
    \hline \centrow 1 & \centrow 2 & \centrow 3 & \centrow 4\\ \hline
    \endfirsthead
    \caption*{Продолжение таблицы \ref{city:table}}\\
    \hline \centrow 1 & \centrow 2 & \centrow 3 & \centrow 4\\ \hline
    \finishhead
    GET /api /City  & Список всех городов City в БД & Нет & [ \{ 
      id: 0, 
      name: <<string>>, 
      description: <<string>> 
        \} 
      ] \\
\end{xltabular}
    

\begin{xltabular}{\textwidth}{|X|p{2.5cm}|>{\setlength{\baselineskip}{0.7\baselineskip}}p{4.85cm}|>{\setlength{\baselineskip}{0.7\baselineskip}}p{4.85cm}|}
    \caption{Описание методов для работы с карточками товаров и услуг\label{product:table}}\\
    \hline \centrow \setlength{\baselineskip}{0.7\baselineskip} HTTP-метод & \centrow \setlength{\baselineskip}{0.7\baselineskip} Описание & \centrow Входные параметры & \centrow Пример JSON ответа \\
    \hline \centrow 1 & \centrow 2 & \centrow 3 & \centrow 4\\ \hline
    \endfirsthead
    \caption*{Продолжение таблицы \ref{product:table}}\\
    \hline \centrow 1 & \centrow 2 & \centrow 3 & \centrow 4\\ \hline
    \finishhead
    GET /api /Product  & Список всех карточек Product & Нет & [
        \{
      id: 0,
      name: <<string>>,
      description: <<string>>,
      imageUrl: <<string>>,
      price: 0,
      createdByUserId: 0,
      cityId: 0,
      productGroupId: 0,
      productStatusId: 0,
      createdAt: <<2024-01-20>>,
      publishedAt: <<2024-01-20>>,
      expiredAt: <<2024-01-20>>,
      priorityId: 0,
      priorityStartedAt: <<2024-01-20>>,
      priorityExpiredAt: <<2024-01-20>>,
      createdByUser: \{
        phone: <<string>>,
        email: <<string>>,
        firstName: <<string>>,
        lastName: <<string>>,
        imageUrl: <<string>>,
        telegram: <<string>>,
        website: <<string>>,
        userRoleId: <<string>>,
        permissions: <<string>>,
        id: 0
          \}
        \}
      ]\\
\hline POST /api /Product  & Создать новый Product & Body: \{
id: 0,
name: <<string>>,
description: <<string>>,
imageUrl: <<string>>,
price: 0,
createdByUserId: 0,
cityId: 0,
productGroupId: 0,
productStatusId: 0,
createdAt: <<2024-01-20>>,
publishedAt: <<2024-01-20>>,
expiredAt: <<2024-01-20>>,
priorityId: 0,
priorityStartedAt: <<2024-01-20>>,
priorityExpiredAt: <<2024-01-20>>,
createdByUser: \{
  phone: <<string>>,
  email: <<string>>,
  firstName: <<string>>,
  lastName: <<string>>,
  imageUrl: <<string>>,
  telegram: <<string>>,
  website: <<string>>,
  userRoleId: <<string>>,
  permissions: <<string>>,
  id: 0
    \}
  \} & \{
id: 0,
name: <<string>>,
description: <<string>>,
imageUrl: <<string>>,
price: 0,
createdByUserId: 0,
cityId: 0,
productGroupId: 0,
productStatusId: 0,
createdAt: <<2024-01-20>>,
publishedAt: <<2024-01-20>>,
expiredAt: <<2024-01-20>>,
priorityId: 0,
priorityStartedAt: <<2024-01-20>>,
priorityExpiredAt: <<2024-01-20>>
  \}\\
\hline GET /api /Product /\{id\} & Получить выбранный Product по его id & Нет & \{
id: 0,
name: <<string>>,
description: <<string>>,
imageUrl: <<string>>,
price: 0,
createdByUserId: 0,
cityId: 0,
productGroupId: 0,
productStatusId: 0,
createdAt: <<2024-01-20>>,
publishedAt: <<2024-01-20>>,
expiredAt: <<2024-01-20>>,
priorityId: 0,
priorityStartedAt: <<2024-01-20>>,
priorityExpiredAt: <<2024-01-20>>
  \}\\
\hline PUT /api /Product /\{id\} & Обновить существующий Product & Body: \{
id: 0,
name: <<string>>,
description: <<string>>,
imageUrl: <<string>>,
price: 0,
createdByUserId: 0,
cityId: 0,
productGroupId: 0,
productStatusId: 0,
createdAt: <<2024-01-20>>,
publishedAt: <<2024-01-20>>,
expiredAt: <<2024-01-20>>,
priorityId: 0,
priorityStartedAt: <<2024-01-20>>,
priorityExpiredAt: <<2024-01-20>>,
createdByUser: \{
  phone: <<string>>,
  email: <<string>>,
  firstName: <<string>>,
  lastName: <<string>>,
  imageUrl: <<string>>,
  telegram: <<string>>,
  website: <<string>>,
  userRoleId: <<string>>,
  permissions: <<string>>,
  id: 0
    \}
  \} & \{
id: 0,
name: <<string>>,
description: <<string>>,
imageUrl: <<string>>,
price: 0,
createdByUserId: 0,
cityId: 0,
productGroupId: 0,
productStatusId: 0,
createdAt: <<2024-01-20>>,
publishedAt: <<2024-01-20>>,
expiredAt: <<2024-01-20>>,
priorityId: 0,
priorityStartedAt: <<2024-01-20>>,
priorityExpiredAt: <<2024-01-20>>
  \}\\
\hline DELETE /api /Product /\{id\} & Удалить Product по его id & Нет & Нет\\
\hline GET /api /Product /filter & Получить отфильтрованный список существующих продуктов & Query parameters: cityId: integer, productGroupId: integer, publishedAtFrom: string, expiredAtTo: string. & [
    \{
  id: 0,
  name: <<string>>,
  description: <<string>>,
  imageUrl: <<string>>,
  price: 0,
  createdByUserId: 0,
  cityId: 0,
  productGroupId: 0,
  productStatusId: 0,
  createdAt: <<2024-01-20>>,
  publishedAt: <<2024-01-20>>,
  expiredAt: <<2024-01-20>>,
  priorityId: 0,
  priorityStartedAt: <<2024-01-20>>,
  priorityExpiredAt: <<2024-01-20>>
    \}
  ]\\
\end{xltabular}

\begin{xltabular}{\textwidth}{|X|p{2.5cm}|>{\setlength{\baselineskip}{0.7\baselineskip}}p{4.85cm}|>{\setlength{\baselineskip}{0.7\baselineskip}}p{4.85cm}|}
    \caption{Описание методов для работы с типами товаров и услуг\label{type:table}}\\
    \hline \centrow \setlength{\baselineskip}{0.7\baselineskip} HTTP-метод & \centrow \setlength{\baselineskip}{0.7\baselineskip} Описание & \centrow Входные параметры & \centrow JSON ответ \\
    \hline \centrow 1 & \centrow 2 & \centrow 3 & \centrow 4\\ \hline
    \endfirsthead
    \caption*{Продолжение таблицы \ref{type:table}}\\
    \hline \centrow 1 & \centrow 2 & \centrow 3 & \centrow 4\\ \hline
    \finishhead
    GET /api /ProductGtoup  & Список всех типов товаров и услуг ProductGroup в БД & Нет & [
        \{
      id: 0,
      name: <<string>>,
      description: <<string>>,
      type: 0,
      childrenProductGroupIds: [
            0
          ],
      parentProductGroupId: 0
        \}
      ]\\
      \hline POST /api /ProductGtoup  & Создать новый ProductGtoup & Body: [
        \{
      id: 0,
      name: <<string>>,
      description: <<string>>,
      type: 0,
      childrenProductGroupIds: [
            0
          ],
      parentProductGroupId: 0
        \}
      ] & [
        \{
      id: 0,
      name: <<string>>,
      description: <<string>>,
      type: 0,
      childrenProductGroupIds: [
            0
          ],
      parentProductGroupId: 0
        \}
      ] \\
\end{xltabular}

\begin{xltabular}{\textwidth}{|X|p{4.85cm}|>{\setlength{\baselineskip}{0.7\baselineskip}}p{2.5cm}|>{\setlength{\baselineskip}{0.7\baselineskip}}p{4.85cm}|}
    \caption{Описание методов для работы с данными пользователя\label{data:table}}\\
    \hline \centrow \setlength{\baselineskip}{0.7\baselineskip} HTTP-метод & \centrow \setlength{\baselineskip}{0.7\baselineskip} Описание & \centrow Входные параметры & \centrow JSON ответ \\
    \hline \centrow 1 & \centrow 2 & \centrow 3 & \centrow 4\\ \hline
    \endfirsthead
    \caption*{Продолжение таблицы \ref{data:table}}\\
    \hline \centrow 1 & \centrow 2 & \centrow 3 & \centrow 4\\ \hline
    \finishhead
    GET /api /User /{id} & Получить данные существующего пользователя User по его id & Нет & \{
    phone: <<string>>,
    email: <<string>>,
    firstName: <<string>>,
    lastName: <<string>>,
    imageUrl: <<string>>,
    telegram: <<string>>,
    website: <<string>>,
    userRoleId: <<string>>,
    permissions: <<string>>,
    id: 0
      \}\\
      \hline POST /api /User /create & Создать нового пользователя User & Body: \{
    phone: <<string>>,
    email: <<string>>,
    firstName: <<string>>,
    lastName: <<string>>,
    imageUrl: <<string>>,
    telegram: <<string>>,
    website: <<string>>,
    userRoleId: <<string>>,
    permissions: <<string>>,
    password: <<string>>
      \} & \{
    phone: <<string>>,
    email: <<string>>,
    firstName: <<string>>,
    lastName: <<string>>,
    imageUrl: <<string>>,
    telegram: <<string>>,
    website: <<string>>,
    userRoleId: <<string>>,
    permissions: <<string>>,
    id: 0,
    hash: <<string>>,
    salt: <<string>>
      \} \\
      \hline POST /api /User /login & Авторизоваться существующим пользователем User в системе. Авторизоваться -\- сохранить в клиентском приложение значение из поля accessToken & Body: \{
    email: <<string>>,
    password: <<string>>
      \} & \{
    phone: <<string>>,
    email: <<string>>,
    firstName: <<string>>,
    lastName: <<string>>,
    imageUrl: <<string>>,
    telegram: <<string>>,
    website: <<string>>,
    userRoleId: <<string>>,
    permissions: <<string>>,
    id: 0,
    accessToken: <<string>>
      \} \\
\end{xltabular}

\renewcommand{\arraystretch}{1.0} % восстановление сетки

\subsection{Модульное тестирование разработанного приложения}


\section{Структура тестового проекта}
В рамках тестирования программного обеспечения был разработан тестовый проект, структура которого представлена на рисунке \ref{testproject_structure:image}. Данный проект включает в себя модульные тесты для различных компонентов системы. Тестирование моделей и контроллеров позволяет обеспечить надежность и корректность работы программного обеспечения.
В тестовый проект добавлена возможность использовать пространство имен из основного проекта с помощью команды: dotnet add reference ../new_back/new_back.csproj.
Тестовый проект включает в себя следующие ключевые элементы:

\begin{itemize}
  \item \textbf{Models}: Классы, которые представляют модели данных, используемые в тестах.
  \item \textbf{Shared}: Вспомогательные классы и утилиты, используемые в различных тестах.
  \item \textbf{TestResults}: Результаты выполнения тестов.
  \item \textbf{UnitTestShort.cs и UnitTestUserController.cs}: Наборы модульных тестов для проверки соответствующих классов и контроллеров.
\end{itemize}

\begin{figure}[ht]
\centering
\includegraphics[width=0.5\textwidth]{testproject_structure.png}
\caption{Структура тестового проекта}
\label{testproject_structure:image}
\end{figure}

Содержимое файла \textbf{ShortTest.cs} представлено на рисунке \ref{st:image}.

\begin{figure}[!ht]
\lstset{style=sharpc}
\begin{lstlisting}
namespace TestProject.Models
{
    [TestClass]
    public class ShortTest
    {
        public long Id { get; set; }
        public string? Name { get; set; }
        public string? Description { get; set; } = null;
    }
}
\end{lstlisting}
\caption{Содержимое файла \textbf{ShortTest.cs}}
\label{st:image}
\end{figure}

Содержимое файла \textbf{Utils.cs} представлено на рисунке \ref{ut:image}.

\begin{figure}[!ht]
\lstset{style=sharpc}
\begin{lstlisting}
namespace TestProject.Shared
{
    public class Utils
    {
        public static void TestString(string v1, string v2)
        {
            if (v1 == null || v2 == null)
            {
                Assert.Fail();
            }

            Assert.AreEqual(v1, v2);
        }

        public static int GenerateUniqueId()
        {
            Random random = new Random();
            return random.Next(1, 101);
        }
    }
}
\end{lstlisting}
\caption{Содержимое файла \textbf{Utils.cs}}
\label{ut:image}
\end{figure}

Содержимое файла \textbf{Usings.cs} представлено на рисунке \ref{usings:image}.

\begin{figure}[!ht]
\lstset{style=sharpc}
\begin{lstlisting}
global using Microsoft.VisualStudio.TestTools.UnitTesting;
global using System.IO;
global using static System.Math;
global using System.Web;
global using Moq;
global using Microsoft.AspNetCore.Mvc;
\end{lstlisting}
\caption{Содержимое файла \textbf{Usings.cs}}
\label{usings:image}
\end{figure}

Модульные тесты для класса Short, который является базовым классом для большинства моделей в приложении, позволяют проверить корректность логики и поведения этого компонента и исключить возникновение проблем в этом классе и его потомков. Тесты охватывают такие аспекты, как валидация имен и описаний, а также уникальность идентификаторов объектов.
Модульные тесты для класса Short представлены на рисунке \ref{unitshort1:image}.

\begin{figure}[ht]
\lstset{style=sharpc}
\begin{lstlisting}
using TestProject.Shared;
using TestProject.Models;

namespace TestProject
{
    [TestClass]
    public class UnitTestShort
    {
        [TestMethod]
        public void Short_Validate_Name()
        {
            var testValue = "Test Name";
            var testObject = new ShortTest() {
                Name = testValue
            };
            Utils.TestString(testObject.Name, testValue);
        }

        [TestMethod]
        public void Short_Validate_Description()
        {
            var testValue = "Test description";
            var testObject = new ShortTest() {
                Description = testValue
            };
            Utils.TestString(testObject.Description, testValue);
        }

        [TestMethod]
        public void Short_Validate_Id()
        {
            var testObject = new ShortTest();
            long randomId = 0;
            while (randomId == 0)
            {
                randomId = Utils.GenerateUniqueId();
            }
            testObject.Id = randomId;
            Assert.AreNotEqual(0, testObject.Id);
            Assert.AreEqual(randomId, testObject.Id);
        }
    }
}  
\end{lstlisting}
\caption{Модульный тест класса Short}
\label{unitshort1:image}
\end{figure}

Для контроллера UserController, который обрабатывает пользовательские запросы, были разработаны тесты, имитирующие взаимодействие с репозиторием данных. Это позволяет тестировать контроллер в изоляции от реальной базы данных, что упрощает процесс разработки и повышает качество кода.
Модульные тесты для UserController представлено на рисунке \ref{unitcontr1:image}.

\begin{figure}[ht]
\lstset{style=sharpc}
\begin{lstlisting}
global using new_back.Controllers;
global using new_back.Infrastructure;
global using new_back.Models;

namespace TestProject
{
    [TestClass]
    public class UserControllerTests
    {
        private Mock<IUserRepository> _mockRepository;
        private UserController _controller;

        [TestInitialize]
        public void SetUp()
        {
            _mockRepository = new Mock<IUserRepository>();
            _controller = new UserController(_mockRepository.Object);
        }

        [TestMethod]
        public void GetById_UserExists_ReturnsUserView()
        {
            long userId = 1;
            var mockUser = new User { Id = userId, Email = "test@example.com" };
            _mockRepository.Setup(repo => repo.GetById(userId)).Returns(mockUser);

            var result = _controller.GetById(userId);

            Assert.IsNotNull(result);
            Assert.IsInstanceOfType(result.Result, typeof(OkObjectResult));

            var okResult = result.Result as OkObjectResult;
            Assert.IsNotNull(okResult);

            var userViewResult = okResult.Value as UserView;
            Assert.IsNotNull(userViewResult);
            Assert.AreEqual(userId, userViewResult.Id);
            Assert.AreEqual("test@example.com", userViewResult.Email);
        }

        [TestMethod]
        public void GetById_UserDoesNotExist_ReturnsNotFound()
        {
            _mockRepository.Setup(repo => repo.GetById(It.IsAny<long>())).Returns((User)null);

            var result = _controller.GetById(1);

            Assert.IsInstanceOfType(result.Result, typeof(NotFoundResult));
        }
    }
}
\end{lstlisting}
\caption{Модульный тест класса UserController}
\label{unitcontr1:image}
\end{figure}

Разработка тестового проекта является ключевым компонентом в цикле обеспечения качества программного продукта. Она демонстрирует эффективность тестирования и его способность гарантировать надежность функционирования системы. На рисунке \ref{testresult:image} представлены результаты выполнения модульных тестов, подтверждающие успешную проверку всех компонентов системы, что свидетельствует об отсутствии критических ошибок и готовности продукта к дальнейшим этапам разработки и внедрения.

\begin{figure}[ht]
\centering
\includegraphics[width=0.8\textwidth]{testresult.png}
\caption{Результаты выполнения модульных тестов}
\label{testresult:image}
\end{figure}

\subsection{Системное тестирование разработанного web-сайта}

На рисунке \ref{main:image} представлена главная страница сайта «Русатом – Аддитивные технологии».
\newpage % при необходимости можно переносить рисунок на новую страницу
\begin{figure}[H] % H - рисунок обязательно здесь, или переносится, оставляя пустоту
\center{\includegraphics[width=1\linewidth]{main1}}
\center{\includegraphics[width=1\linewidth]{main2}}
\center{\includegraphics[width=1\linewidth]{main3}}
\caption{Главная страница сайта «Русатом – Аддитивные технологии»}
\label{main:image}
\end{figure}

На рисунке \ref{menu:image} представлен динамический вывод заголовков, включающий в себя искомые фразы при поиске фраз.

\begin{figure}[ht]
\center{\includegraphics[width=1\linewidth]{menu}}
\caption{Динамический вывод заголовков}
\label{menu:image}
\end{figure}

На рисунке \ref{enter:image} представлен ввод данных для публикации новости.

\begin{figure}[ht]
\center{\includegraphics[width=1\linewidth]{enter}}
\caption{Ввод данных для публикации очень-очень длинной, интересной и полезной новости}
\label{enter:image}
\end{figure}
